Digraph: a Directed Graph library
=================================

By Philip M. Hubbard, 2013


Overview
--------

Digraph is a Java library that implements directed graphs.  It has some functionality for processing directed graphs with map-reduce algorithms in Hadoop.  While Digraph has some general capabilities, it was specifically designed to support the Sabe library, for experiments in genome sequence assembly by Euler tours.

Implementation
--------------

The abstract `Digraph<E>` generic class implements some common directed graph functionality where vertices are specified by `int` indices and edges are specified by the generic type parameter.  The idea is that a subclass class could specify custom data for the vertices by using vertex-indexed lists, and custom data for the edges through the generic type parameter.  Algorithms that do not need to add edges, like Euler tour computation, can use the `Digraph<E>` class interface.

The `BasicDigraph` class is a subclass of `Digraph<E>` that implements the simplest possible directed graph, with no custom data for the vertices or edges.

The `EulerPaths` class computes Euler tours of of `Digraph<E>` instances, that is, paths that visit every edge exactly once.  The class implements a classic algorithm with processing time that is linear in the number of edges.

The `MRVertex` class implements a directed-graph vertex for use with Hadoop map-reduce algorithms.  To support the distributed nature of map-reduce algorithms, this vertex is independent of a global graph structure like `Digraph<E>`; instead, each `MRVertex`
keeps its own record of the indices of its adjacent vertices, and can read and write this information from and to a Hadoop `Writable` instance, a `Text`.

The `MRCollectVertexEdges` class implements the Hadoop mapper and reducer for taking vertices that know only their edges pointing out to other vertices, and producing vertices that also know the edges pointing in from other vertices.  This work is useful for the processing of the De Bruijn graphs generated by the Sabe library.  By default, the`MRCollectVertexEdges.Mapper` class takes the `Text` representation of a `MRVertex` as input, but it has a `verticesFromInputValue()` function that can be defined by subclasses to generate a `ArrayList<MRVertex` from any input data.  Sabe has a subclass that uses this function to generate vertices from genome "read" strings.

Testing
-------

The main routine of the `DigraphTest` class calls routines from the `BasicDigraphTest`, `EulerPathsTest` and `MRVertexTest` classes to run confidence tests on the `BasicDigraph`, `EulerPaths` and `MRVertex` classes, respectively.  These tests use `assert()` so the run configuration must be set to include "-ea" in the VM arguments.

The `MRCollectVertexEdgesTest` class tests the `MRCollectVertexEdges` and `MRVertex` classes by running a Hadoop job.

Building
--------

This library was developed with the Eclipse Kepler (4.3.1) IDE on OS X.  The Hadoop-related classes require that the following external JARs from the Hadoop 2.2.0 installation be added (e.g., through the "Build Path/Configure Build Path…/Libraries/Add External JARs…" menu in Eclipse):

* share/hadoop/common/lib/commons-cli-1.2.jar
* share/hadoop/common/hadoop-common-2.2.0.jar
* share/hadoop/mapreduce/hadoop-mapreduce-client-core.2.2.0.jar


Future Work
------------

* The `EulerPaths` class does not check that the `Digraph<E>` has vertices that all meet the condition necessary for the existence of an Euler tour: that every vertex in the graph has an in degree that equals its out degree.  Processing a graph that does not meet this condition will have unpredictable results.  There should be heuristics to deal with this situation, as it could occur in the use of this class by Sabe, the library for genome sequence assembly based on Euler tours.  The result would be paths that are not necessarily real tours, hence the name of this class.

* It ought to be possible to make the `Digraph<E>.AdjacencyIterator` and `MRVertex.AdjacencyIterator` classes use the `Iterator<A>` interface.
